!function(t,e){"use strict";var n,o=t.__SoulStore__=t.__SoulStore__||{},a=[],r={},d=function(t,e){for(var n,o=0,a=t.length;n=t[o],o<a;o+=1)e(n,o,t)},i=function(t,e,n){d(t.querySelectorAll(e),n)},c=function(e,n){var o=new CustomEvent("store-changed",{detail:{value:e,path:n},bubbles:!1});t.dispatchEvent(o)},s=function(t,e){var n=e,o=null;return d(t.split("."),function(t,e,a){if(e>=a.length-1)return o=t,void("*"===t&&(t=n.length));"*"!==t&&(!n[t]&&e<a.length-1&&(n[t]={},"*"===a[e+1]&&(n[t]=[])),n=n[t])}),{cursor:n,index:o}},u=function(t,e){var n=s(t,e);return n.cursor[n.index]};function l(t,n){t=t||e.body,n=n||o,i(t,"[data-bind]",function(t,e){if(!t.bindAttached){t.bindAttached=!0;var o=t.dataset.bind.split(":"),a=o[0],r=o[1];r||(r=a,a="INPUT"===t.nodeName||"SELECT"===t.nodeName||"TEXTAREA"===t.nodeName?"value":"textContent"),!t.context&&t.dataset.context&&JSON.parse(t.dataset.context)&&(t.context=JSON.parse(t.dataset.context));var d=s(r,t.context||n),i=u(r,t.context||n);d.cursor[d.index]=i||t[a],t.boundObject=d;var l=d.cursor[d.index];"function"==typeof l?void 0!==(l=d.cursor[d.index](t,t.context||n))&&(t[a]=l||""):t[a]=l||"",["input","select","textarea"].indexOf(t.nodeName.toLowerCase())>=0&&t.addEventListener("change",function(){"*"===r.split(".").pop()&&(d.index=d.cursor.length),"function"==typeof d.cursor[d.index]?d.cursor[d.index](t,t.context||n,this[a]):d.cursor[d.index]=this[a],c(this[a],r)},!1)}})}function f(t,n){t=t||e.body,n=n||o,i(t,"[data-toggle]",function(t){if(!t.toggleAttached){t.toggleAttached=!0;var e=t.dataset.toggle.split(":"),o=e[0],a=e[1];a||(o="click",a=e[0]),!t.context&&t.dataset.context&&JSON.parse(t.dataset.context)&&(t.context=JSON.parse(t.dataset.context));var r=s(a,t.context||n);if("hover"===o){var d=r.cursor[r.index];t.addEventListener("mouseover",function(){r.cursor[r.index]=!d,c(r.cursor[r.index],a,t.context||n)}),t.addEventListener("mouseout",function(){r.cursor[r.index]=d,c(r.cursor[r.index],a,t.context||n)})}else t.addEventListener(o,function(){r.cursor[r.index]=!r.cursor[r.index],c(r.cursor[r.index],a,t.context||n)})}})}function v(t,n){t=t||e.body,n=n||o,i(t,"[data-action]",function(t){if(!t.actionAttached){t.actionAttached=!0;var e=t.dataset.action.split(":"),o=e[0],a=e[1],r=e[2];!r&&o&&a&&["click","mouseover","mouseout","mousemove","mousedown","mouseenter","mouseleave","submit","load","focus","blur","animationstart","animationend","animationiteration","dblclick","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","ended","error","invalid","keydown","keypress","keyup","change","play","pause","playing","seeked","touchstart","touchend","touchmove"].indexOf(o.toLowerCase())<0&&(r=a,a=o,o="click"),o&&!a&&(a=o,o="click"),!t.context&&t.dataset.context&&JSON.parse(t.dataset.context)&&(t.context=JSON.parse(t.dataset.context));var d=u(a,t.context||n);"function"==typeof d&&t.addEventListener(o.toLowerCase(),function(o){o.preventDefault(),r&&(r=u(r,t.context||n)),d(t,t.context||n,r,e[e.length-1]),c()})}})}function x(t,e){l(t,e),f(t,e),v(t,e)}x(),t.addEventListener("store-changed",function(t){i(e.body,"[data-bind]",function(t){if(!t.dataset.load){var e=t.dataset.bind.split(":"),n=e[0],a=e[1];if(a||(a=n,n=["input","select","textarea"].indexOf(t.nodeName.toLowerCase())>=0?"value":"textContent"),t.boundObject){var r=t.boundObject.cursor[t.boundObject.index];"function"==typeof r&&(r=r(t,t.context||o)),t[n]!==r&&void 0!==r&&(t[n]=r||"")}}}),a.forEach(function(t,e){if(!t.node.isConnected)return a.splice(e,1);t.render(),x(t.node,t.node.context)})}),i(e.body,"[data-load]",n=function(t){var e=t.dataset.load,n=t.dataset.bind,d=t.dataset.context;if(d&&(d=JSON.parse(d)),t.context=d,n){var i=s(n,d||o);t.context=i.cursor[i.index]||{},d=t.context}var c=function(t,e,n){a.push({render:function(){var a=e||o,r=n.render(a);t.lastRendered!==r&&(t.innerHTML=r,t.lastRendered=r)},node:t}),a[a.length-1].render(),x(t,e)}.bind(null,t,d);if(e.match(/\.js$/)||(e+=".js"),r[e])return c(r[e]);fetch(e).then(function(t){return t.text()}).then(function(t){var n='var module = {exports:{}};var require=function(path){return{render:function(data){return "<div data-load=\\"'+e.replace(/\w+(\.\w+)?$/,"")+"\" + path + \"\\\" data-context='\" + JSON.stringify(data).replace(/'/g, '\\'') + \"'></div>\";}}};"+t+";return module.exports;",o=new Function(n)();return r[e]=o,o}).then(c)}),new MutationObserver(function(t){for(var e in t){for(var o,r=0,d=[].slice.call(t[e].addedNodes),i=d.length;o=d[r],r<i;r+=1)if(o.dataset&&o.dataset.load)n(o);else if(o.dataset&&o.dataset.bind)l(o);else if(o.dataset&&o.dataset.toggle)f(o);else if(o.dataset&&o.dataset.action)v(o);else if(1===o.nodeType){var c=o.querySelectorAll("[data-load]");c.length>0&&(i=(d=d.concat([].slice.call(c))).length)}for(r=0,i=(d=[].slice.call(t[e].removedNodes)).length;o=d[r],r<i;r+=1)for(var s=a.filter(function(t){return t.node===o});s.length>0;){var u=a.lastIndexOf(s.pop());a.splice(u,1)}}}).observe(e.body,{subtree:!0,childList:!0})}(window,document),function(){if("function"==typeof window.CustomEvent)return!1;function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}t.prototype=window.Event.prototype,window.CustomEvent=t}();
